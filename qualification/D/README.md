# D. Живая сталь (40 баллов)

На планете Ксетаксис живёт два племени огромных боевых человекоподобных роботов, которые уже давно воюют друг с другом.

Представители более развитой расы «космических жокеев» с другой планеты, которые сканируют Вселенную в поисках разумной жизни, установили, что в стародавние времена по планете прошёл компьютерный вирус, который изменил таблицы во внутренней документации некоторых роботов — с markdown-подобного внутреннего формата на HTML. Из-за этого общение между роботами было нарушено и разразилась война.

Помогите написать скрипт, который сконвертирует таблицы обратно во внутренний формат, понятный каждому роботу, и восстановит мир на планете. Роботы не должны страдать!

Вам нужно написать функцию, которая на вход принимает HTML таблицы и преобразует его в wiki-подобную разметку.

В качестве решения этого задания отправьте файл .js, в котором объявлена функция solution: 

```javascript
function solution(input) {  
    // ...  
}
```
## Формат ввода

HTML таблицы приходит в виде строки:

```html
<table>  
    <colgroup>  
        <col    align="right"    />  
        <col />  
        <col align="center"/>  
    </colgroup>  
    <thead>  
        <tr>  
            <td>Command    </td>  
            <td>    Description</td>  
            <th>Is implemented    </th>  
        </tr>  
    </thead>  
    <tbody>  
        <tr>  
            <th>git status   </th>  
            <td>   List all new or modified files</td>  
            <th>Yes   </th>  
        </tr>  
        <tr>  
            <th>git diff</th>  
            <td>Show file differences that have not been staged</td>  
            <td>No</td>  
        </tr>  
    </tbody>  
</table>
```

В таблице могут содержаться теги *colgroup*, *thead* и *tbody* в фиксированном порядке.  
Все эти теги опциональны, но всегда будет присутствовать как минимум *thead* либо *tbody*.
- *colgroup* содержит теги *col*, у которых может быть опциональный атрибут *align* с одним из трёх значений (left|center|right)
- *thead* и *tbody* содержат 1 или более *tr*
- *tr*, в свою очередь, содержат как *td*, так и *th*

В таблице всегда будет хотя бы одна строка.  
В строке всегда будет хотя бы одна ячейка.  
В ячейке всегда присутствует хотя бы один не-whitespace символ.

Количество элементов *th/td* в строках всегда совпадает между всеми строками и с количеством элементов *col* в *colgroup*, при наличии *colgroup*.

Пробелы и переносы строк в исходном HTML могут встречаться в любом месте, не нарушающем валидность HTML.

## Формат вывода

На выходе должна получиться строка с wiki-подобной разметкой:

```
^  Command ^ Description  ^  Is implemented  ^
^  git status | List all new or modified files  ^  Yes  |
^  git diff | Show file differences that have not been staged  |  No  |
```

Разделитель перед ячейкой таблицы выводится в зависимости от того, *th* это или *td*. 
Карет для *th* — `^`, и вертикальная черта для *td* — `|`.

Все ячейки строк из *thead* должны быть разделены через карет вне зависимости от того, *td* это или *th*.  
Все строки, получившиеся из *thead*, должны завершаться каретом, а из *tbody* — вертикальной чертой.

Пробелы по краям содержимого тегов *td* и *th* должны быть удалены.  
Переносы строк в содержимом ячеек должны быть удалены.  
Более одного пробела подряд в содержимом ячеек должны быть заменены одним пробелом.

За выравнивание в ячейках столбцов результирующей wiki-подобной таблицы отвечают пробелы вокруг содержимого ячейки:

```
| xxx  | два пробела справа и один слева значит выравнивание влево  
|  xxx  | два пробела по обоим сторонам значат выравнивание по центру  
|  xxx | два слева и один справа — по правому краю
```

При отсутствии заданного в теге col атрибута align выравнивание должно быть задано влево.

## Примечания

- Для перевода строки нужно использовать символ `\n`.
- Решение будет проверяться в браузерном окружении (**Chrome 78**) с доступом к объектам *document* и *window*.
- Можно использовать синтаксис до **es2018** включительно.
